<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="p">
	<insert id="payment_insert"
		parameterType="portOne_api.PaymentVO"> insert into payment ( payment_id, imp_uid,
		merchant_uid, pay_method, currency, paid_amount, paid_at, status,
		card_name, card_number, buyer_name, product_name, buyer_tel,
		buyer_addr, buyer_postcode, receipt_url, deliveryrequest, product_id,
		quantity) values ( SEQ_PAY_IDX.nextVal, #{imp_uid}, #{merchant_uid},
		#{pay_method}, #{currency}, #{paid_amount}, #{paid_at}, #{status},
		#{card_name}, #{card_number}, #{buyer_name}, #{product_name},
		#{buyer_tel}, #{buyer_addr}, #{buyer_postcode}, #{receipt_url},
		#{deliveryRequest}, #{product_id}, #{quantity})
	</insert>


	<!-- merchant_uid 조회 -->
	<select id="payment_select_one" parameterType="String"
		resultType="payment"> SELECT * FROM ( SELECT * FROM payment WHERE
		merchant_uid =
		#{merchant_uid} ORDER BY payment_id ASC ) WHERE ROWNUM
		&lt;= 1 </select>


	<!-- 상품이름 리스트로 가져옴 -->
	<select id="payemnt_productName_selectAll" resultType="String"
		parameterType="String"> select product_name from payment where merchant_uid =
		#{merchant_uid}
	</select>


	<select id="paid_total_amount" parameterType="String"
		resultType="int">
		SELECT SUM(paid_amount)
		FROM payment p
		WHERE p.merchant_uid = #{order_id}
	</select>

	<update id="thread_ststus_update" parameterType="java.util.Map"> update payment
		set status = #{status} where merchant_uid = #{merchant_uid} </update>

</mapper>












