<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="u">

	<!-- 네이버 -->
	<insert id="naver_user_insert" parameterType="user"> insert into users
		values(seq_user_idx.nextval,
		#{user_id},#{user_name},null,#{phone,jdbcType=VARCHAR},#{email},'naver',null,null,null,sysdate,
		1,#{gender}, null) </insert>
		
	<!-- 구글 -->
	<insert id="google_user_insert" parameterType="user"> insert into users
		values( seq_user_idx.nextval, #{user_id}, #{user_name}, null,
		#{phone,jdbcType=VARCHAR}, #{email}, 'google', null, null, null, sysdate, 1, null,
		null) </insert>
		
	<!-- 카카오 -->
	<insert id="kakao_user_insert" parameterType="user"> insert into users
		values( seq_user_idx.nextval, #{user_id}, #{user_name}, null,
		#{phone,jdbcType=VARCHAR}, #{email}, 'kakao', null, null, null, sysdate, 1, #{gender},
		null) </insert>
		
		
	<insert id="local_user_insert" parameterType="user"> insert into users
		values(seq_user_idx.nextval, #{user_id}, #{user_name}, #{user_pwd},
		#{phone}, #{email}, 'local', null, null, null, sysdate, 1, null, null)
	</insert>
	
	
	<!-- ID조회 -->
	<select id="user_id_email_select" parameterType="java.util.Map"
		resultType="user"> select * from users where user_id = #{user_id} or email =
		#{email} </select>
		
		
	<!-- 아이디 체크 -->
	<select id="user_id_check" parameterType="String"
		resultType="int"> select count(*) from users where user_id = #{user_id}
	</select>
	
	
	<!-- 로컬 로그인 / 아이디 비번 확인 -->
	<select id="user_id_pwd_check" parameterType="java.util.Map"
		resultType="user"> select * from users where user_id = #{user_id} and
		user_pwd = #{user_pwd} </select>
	
	
	<!-- 아이디 찾기 -->
	<select id="user_id_find" parameterType="String"
		resultType="user"> select * from users where email = #{email} 
	</select>
	
	<!-- 비밀번호 재설정 -->
	<update id="pwd_reset" parameterType="java.util.Map"> 
		update users set user_pwd = #{user_pwd} where email = #{email} 
	</update>
	
	<!-- 유저정보 업데이트 비번x -->
	<update id="user_edit_update" parameterType="user">
	    update users 
	    set 
        user_name = #{user_name},
        email = #{email},
        phone = #{phone},
        zipcode = #{zipcode},
        address1 = #{address1},
        address2 = #{address2}
        <if test="user_pwd != null and user_pwd != ''">
            , user_pwd = #{user_pwd}
        </if>
	    where user_idx = #{user_idx}
	</update>
	
	<!-- 유저정보 조회 -->
	<select id="user_select" parameterType="user" resultType="user"> 
		select * from users where user_idx = #{user_idx}
	</select>
	
	
	<select id="select_user_idx" resultType="user" parameterType="int">
		select * from users where user_idx = #{user_idx}
	</select>
	
	<select id="user_select_listAll" resultType="user"> select * from users </select>

</mapper>












